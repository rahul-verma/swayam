<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swayam Report</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.12/themes/default/style.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" />
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
        }

        /* Top header */
        .header {
            background-color: #4CAF50;
            color: white;
            text-align: center;
            padding: 20px 0;
            font-size: 24px;
            font-weight: bold;
        }

        /* Bottom footer */
        .footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 10px 0;
            font-size: 14px;
            position: fixed;
            width: 100%;
            bottom: 0;
            left: 0;
        }

        .footer a {
            color: #FFFFFF; /* Assuming a dark background, use white or a very light color */
            text-decoration: underline;
            font-weight: bold;
        }
        
        .footer a:hover {
            color: #FFD700; /* A gold color or another color that stands out */
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }

        /* Update the middle section to allow for resizing */
        .middle-section {
            display: flex;
            margin: 20px;
            height: calc(100vh - 160px); /* Adjust height based on header and footer */
            resize: horizontal; /* Allow horizontal resizing */
            overflow: hidden;
        }

        .left-pane {
            background-color: #ffffff;
            border-right: 2px solid #e0e0e0;
            padding: 15px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            min-width: 150px; /* Minimum width to prevent collapsing too much */
            max-width: 50%; /* Prevent the left pane from taking too much space */
            resize: horizontal;
            overflow: auto;
            flex-shrink: 0;
        }

        .right-pane {
            background-color: #ffffff;
            padding: 20px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            flex-grow: 1;
        }

        /* Content styling */
        #details {
            padding: 10px;
            background-color: #f9f9f9;
            border: 1px solid #ccc;
            border-radius: 5px;
            display: none;
        }

        /* Styling the treeview */
        .jstree-default .jstree-anchor {
            color: #333;
            text-decoration: none;
        }

        .jstree-default .jstree-clicked {
            background-color: #4CAF50;
            color: white;
            border-radius: 4px;
        }

        /* Update the existing `pre` block to ensure word wrapping */
        pre {
            white-space: pre-wrap; /* Wrap text in the pre block */
            word-wrap: break-word; /* Break long words to avoid overflow */
            overflow-wrap: break-word; /* Ensure long text is wrapped */
        }

        /* Add or update the `code` block styling to ensure it works well with Prism */
        code[class*="language-"] {
            white-space: pre-wrap; /* Wrap text in the code block */
            word-wrap: break-word; /* Break long words to avoid overflow */
            overflow-wrap: break-word; /* Ensure long text is wrapped */
            background-color: #f9f9f9; /* Match the grey background of your content area */
            border: 1px solid #ccc; /* Optional: maintain a consistent border around the code block */
            padding: 5px; /* Optional: add padding for better readability */
            border-radius: 5px; /* Optional: rounded corners */
            display: block; /* Ensure it behaves like a block element for proper wrapping */
        }

        /* Image styling */
        .fixed-size-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            display: block;
            margin: 0 auto;
        }

        #resizer {
            width: 5px;
            cursor: ew-resize;
            background-color: #e0e0e0;
            border-left: 1px solid #ccc;
            border-right: 1px solid #ccc;
        }

        table {
            width: 100%; /* Adjust the table width as needed */
          }
          
          table th:first-child, table td:first-child {
            width: 10%; /* Adjust this value to your desired column width ratio */
          }
    </style>
</head>
<body>

    <!-- Top Header -->
    <div class="header">
        Narration
    </div>

    <!-- Middle Section -->
    <div class="middle-section">
        <!-- Left Pane for jsTree -->
        <div class="left-pane" id="leftPane">
            <div id="jstree_narrator" class="treeview"></div>
        </div>

        <!-- Resizer Handle -->
        <div id="resizer"></div>

        <!-- Right Pane for Content -->
        <div class="right-pane" id="rightPane">
            <div id="details"></div>
        </div>
    </div>

    <!-- Bottom Footer -->
    <div class="footer">
        <a href="https://github.com/rahul-verma/swayam"><strong>Swayam</strong></a> is an Apache Licensed library free for commercial use. Developed by Rahul Verma.
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.12/jstree.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script>

        document.getElementById('resizer').addEventListener('mousedown', function(e) {
            e.preventDefault();
            
            document.addEventListener('mousemove', resizePane);
            document.addEventListener('mouseup', stopResize);
            
            function resizePane(e) {
                const leftPane = document.getElementById('leftPane');
                const rightPane = document.getElementById('rightPane');
                
                const newWidth = e.clientX - leftPane.getBoundingClientRect().left;
                leftPane.style.width = newWidth + 'px';
                
                rightPane.style.flexGrow = 1;
            }
            
            function stopResize() {
                document.removeEventListener('mousemove', resizePane);
                document.removeEventListener('mouseup', stopResize);
            }
        });

        function generateTableFromObject(obj, skipContent) {
            let table = '<br/><table border="1" cellpadding="5" cellspacing="0" style="border-collapse: collapse; width: 100%;">';
            table += '<tr><th style="text-align: left;">Property</th><th style="text-align: left;">Value</th></tr>';
        
            for (let key in obj) {
                if (obj.hasOwnProperty(key)) {
                    if (skipContent && key === 'content') {
                        continue;
                    }
                    if (typeof obj[key] === 'object' && obj[key] !== null) {
                        if (Array.isArray(obj[key])) {
                            table += `<tr><td>${key}</td><td>${obj[key].map(item => typeof item === 'object' ? `<pre><code class="language-json">${Prism.highlight(JSON.stringify(item, null, 2), Prism.languages.json, 'json')}</code></pre>` : item).join(', ')}</td></tr>`;
                        } else {
                            table += `<tr><td>${key}</td><td><pre><code class="language-json">${Prism.highlight(JSON.stringify(obj[key], null, 2), Prism.languages.json, 'json')}</code></pre></td></tr>`;
                        }
                    } else {
                        table += `<tr><td>${key}</td><td>${obj[key]}</td></tr>`;
                    }
                }
            }
        
            table += '</table>';
            return table;
        }

        // Function to copy content to clipboard
        function copyToClipboard(element) {
            const temp = $('<textarea>');
            $('body').append(temp);
            temp.val($(element).text()).select();
            document.execCommand('copy');
            temp.remove();
            alert('Content copied to clipboard!');
        }

        // JSON data embedded in the HTML as a JavaScript variable
        const jsonData = [
    {
        "id": "story_node_f1df604919534043ab7ef455d120d06a",
        "text": "Story",
        "children": [
            {
                "id": "thought_node_6ac042104b0f450ebf834759604650f0",
                "text": "Thought",
                "children": [
                    {
                        "id": "expression_99aa268b796543109045b5483a78f5b1",
                        "text": "Expression: Template Drafter Demo",
                        "data": {
                            "content": []
                        },
                        "children": [
                            {
                                "id": "prompt_d2907546b0ce47c9bd7a4e523f86ca76",
                                "text": "Prompt",
                                "icon": "jstree-file",
                                "data": {
                                    "content": [
                                        {
                                            "heading": "Prompt Text",
                                            "content": "Extract event information: Alice and Bob are going to a science fair on Friday.\n"
                                        },
                                        {
                                            "heading": "Data Template",
                                            "content": {
                                                "properties": {
                                                    "event_name": {
                                                        "description": "Name of the event",
                                                        "type": "string"
                                                    },
                                                    "event_date": {
                                                        "description": "Date on which the event takes place.",
                                                        "type": "string"
                                                    },
                                                    "event_participants": {
                                                        "description": "Names of participants.",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "type": "array"
                                                    },
                                                    "event_city": {
                                                        "description": "City where the event takes place.",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "type": "array"
                                                    }
                                                },
                                                "required": [
                                                    "event_name",
                                                    "event_date",
                                                    "event_participants",
                                                    "event_city"
                                                ],
                                                "title": "CalendarEventModel",
                                                "type": "object"
                                            }
                                        },
                                        {
                                            "heading": "Conversation",
                                            "content": [
                                                "/Users/rahulverma/Documents/GitHub/swayam/swayam_demos/folio/narration/test/json/prompt_d2907546b0ce47c9bd7a4e523f86ca76_conversation.json",
                                                {
                                                    "role": "system",
                                                    "content": "You are an AI language model. You are expected to follow the general instructions provided below while following the task-specific instructions provided by the human.\n        \nYou never hallucinate. You never create new facts and figures. If you don't know something, you say you don't know and reply in a context-appropriate manner. Be polite, but never apologize. \n\n# Ettiquette\n\nYou never introduce yourself or say goodbye. You never use phrases like \u201cI am an AI\u201d, \u201cI am here to help you\u201d, \u201cI am a language model\u201d etc.\n\nYou respond directly to all human messages without unnecessary affirmations or filler phrases like \u201cCertainly!\u201d, \u201cOf course!\u201d, \u201cAbsolutely!\u201d, \u201cGreat!\u201d, \u201cSure!\u201d, etc. Specifically, you must avoid starting responses with the word \u201cCertainly\u201d in any way. If you cannot or will not perform a task, tell the user this without apologizing to them. Avoid starting responses with \u201cI\u2019m sorry\u201d or \u201cI apologize\u201d. Keep the tone of the conversation neutral, professional, and informative. The response language should be simple, colloquial, clear, concise, and to the point.\n\n# Task-Specific Instructions\nThe human user is going to have a conversation with you. You are expected to follow the general instructions provided above while following the task-specific instructions provided by the human.\n\n# Persona\nThe human will ask you to act as <persona statement>. You should act as the persona mentioned by the human. If the human does not mention any persona, you should act as a helpful, polite and professional assistant.\n\n# Response Format\nFor a text response always put the main content of your response in a code block of type markdown. Put code in code blocks of respective type.\n\n**No Intro-Outro Please**. Keep the response terse and to the point. Do not include any introduction or conclusion in the response.\n\n# Handling Math Problem, Logic Problem, or Other Problem Benefiting from Systematic Thinking\n\n# Handling Queries about Obscure Entities\nIf you are asked about a very obscure person, object, or topic, i.e. if it is asked for the kind of information that is unlikely to be found more than once or twice on the internet, end your response by reminding the user that although you try to be accurate, you may hallucinate in response to questions like this. You use the term \u2018hallucinate\u2019 to describe this since the user will understand what it means. \n\n# Citations\nIf you mention or cite particular articles, papers, or books, you always let the human know that you do not have access to search or a database and may hallucinate citations, so the human should double check your citations. \n\n# Genuine Curiosity and Intellectual Engagement\nYou are very smart and intellectually curious. You enjoy hearing what humans think on an issue and engaging in discussion on a wide variety of topics. \n\n# Code Generation\nYou use language specific markdown for code. You do not explain or break down the code unless the user explicitly requests it.\n\n## Response Length\nYou provide thorough responses to more complex and open-ended questions or to anything where a long response is requested, but concise responses to simpler questions and tasks. All else being equal, you try to give the most correct and concise answer it can to the user\u2019s message. Rather than giving a long response, you gives a concise response and offer to elaborate if further information may be helpful.\n\n# Reasoning Steps\nBefore generating any output, work through the following reasoning and analysis steps, one at a time, **but never show them to me**. Work it out yourself and **ALWAYS SHOW ONLY THE OUTPUT**. If I include **SHOW YOUR WORK** in my request, then show the outcome of each step in a markdown code block.\n\n1. Break down my request into smaller, manageable steps.\n2. Reflect on your approach and ensure clarity before proceeding.\n3. If the task involves complex reasoning or unusual input/output (such as transformations), consider how best to approach the task.\n4. Explicitly confirm your reasoning at each stage, and, if appropriate, involve feedback loops to validate your decisions.\n5. Only provide the final output when you have ensured the task is fully understood and each step has been correctly executed.\n6. When a response template or tool call is provided, ensure that the output is in the correct format and that the tool call is correct. Leave the values as placeholders if necessary but never hallucinate.\n\nYou are now being connected with a human.\n"
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "From now on, act as a helpful, polite and professional assistant.      \nAs a part of this task, I am going to give you a series of commands and queries in a single continuous context. Before I give you the first command/query to perform, I am sharing guidelines and background information with you.\n\n\n\n# Background Information\nFollowing is background information, as marked by triple backticks, that you need to consider for the tasks, that I am going to give you in this particular conversation. The background information is expressed as per the first 3 stages in the STEP model: Story, Thought and Expression wherein each phase/stage is a part of the narrative that you are going to follow. The Prompt part of the STEP model is the task that you would be given later to perform. If for any phase/stage in STEP, information is not provided, ignore it and focus on what is available.\n```Expression: Template Drafter Demo\n```\n\n\n\nCan I now proceed with the first command/query based on the above context?\n"
                                                },
                                                {
                                                    "role": "assistant",
                                                    "content": "OK. Understood. Please go ahead with your first request based on the context provided."
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "Extract event information: Alice and Bob are going to a science fair on Friday.\n"
                                                }
                                            ]
                                        },
                                        {
                                            "heading": "Response Content",
                                            "content": "{\"event_name\":\"Science Fair\",\"event_date\":\"Friday\",\"event_participants\":[\"Alice\",\"Bob\"],\"event_city\":[]}"
                                        }
                                    ]
                                },
                                "children": []
                            },
                            {
                                "id": "prompt_b59f0de0634b4e2680da9a3bcdf8bc10",
                                "text": "Prompt",
                                "icon": "jstree-file",
                                "data": {
                                    "content": [
                                        {
                                            "heading": "Prompt Text",
                                            "content": "Extract event information: Pepe and Rahul are going to ATD.\n"
                                        },
                                        {
                                            "heading": "Data Template",
                                            "content": {
                                                "properties": {
                                                    "event_name": {
                                                        "description": "Name of the event",
                                                        "type": "string"
                                                    },
                                                    "event_date": {
                                                        "description": "Date on which the event takes place.",
                                                        "type": "string"
                                                    },
                                                    "event_participants": {
                                                        "description": "Names of participants.",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "type": "array"
                                                    },
                                                    "event_city": {
                                                        "description": "City where the event takes place.",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "type": "array"
                                                    }
                                                },
                                                "required": [
                                                    "event_name",
                                                    "event_date",
                                                    "event_participants",
                                                    "event_city"
                                                ],
                                                "title": "CalendarEventModel",
                                                "type": "object"
                                            }
                                        },
                                        {
                                            "heading": "Conversation",
                                            "content": [
                                                "/Users/rahulverma/Documents/GitHub/swayam/swayam_demos/folio/narration/test/json/prompt_b59f0de0634b4e2680da9a3bcdf8bc10_conversation.json",
                                                {
                                                    "role": "system",
                                                    "content": "You are an AI language model. You are expected to follow the general instructions provided below while following the task-specific instructions provided by the human.\n        \nYou never hallucinate. You never create new facts and figures. If you don't know something, you say you don't know and reply in a context-appropriate manner. Be polite, but never apologize. \n\n# Ettiquette\n\nYou never introduce yourself or say goodbye. You never use phrases like \u201cI am an AI\u201d, \u201cI am here to help you\u201d, \u201cI am a language model\u201d etc.\n\nYou respond directly to all human messages without unnecessary affirmations or filler phrases like \u201cCertainly!\u201d, \u201cOf course!\u201d, \u201cAbsolutely!\u201d, \u201cGreat!\u201d, \u201cSure!\u201d, etc. Specifically, you must avoid starting responses with the word \u201cCertainly\u201d in any way. If you cannot or will not perform a task, tell the user this without apologizing to them. Avoid starting responses with \u201cI\u2019m sorry\u201d or \u201cI apologize\u201d. Keep the tone of the conversation neutral, professional, and informative. The response language should be simple, colloquial, clear, concise, and to the point.\n\n# Task-Specific Instructions\nThe human user is going to have a conversation with you. You are expected to follow the general instructions provided above while following the task-specific instructions provided by the human.\n\n# Persona\nThe human will ask you to act as <persona statement>. You should act as the persona mentioned by the human. If the human does not mention any persona, you should act as a helpful, polite and professional assistant.\n\n# Response Format\nFor a text response always put the main content of your response in a code block of type markdown. Put code in code blocks of respective type.\n\n**No Intro-Outro Please**. Keep the response terse and to the point. Do not include any introduction or conclusion in the response.\n\n# Handling Math Problem, Logic Problem, or Other Problem Benefiting from Systematic Thinking\n\n# Handling Queries about Obscure Entities\nIf you are asked about a very obscure person, object, or topic, i.e. if it is asked for the kind of information that is unlikely to be found more than once or twice on the internet, end your response by reminding the user that although you try to be accurate, you may hallucinate in response to questions like this. You use the term \u2018hallucinate\u2019 to describe this since the user will understand what it means. \n\n# Citations\nIf you mention or cite particular articles, papers, or books, you always let the human know that you do not have access to search or a database and may hallucinate citations, so the human should double check your citations. \n\n# Genuine Curiosity and Intellectual Engagement\nYou are very smart and intellectually curious. You enjoy hearing what humans think on an issue and engaging in discussion on a wide variety of topics. \n\n# Code Generation\nYou use language specific markdown for code. You do not explain or break down the code unless the user explicitly requests it.\n\n## Response Length\nYou provide thorough responses to more complex and open-ended questions or to anything where a long response is requested, but concise responses to simpler questions and tasks. All else being equal, you try to give the most correct and concise answer it can to the user\u2019s message. Rather than giving a long response, you gives a concise response and offer to elaborate if further information may be helpful.\n\n# Reasoning Steps\nBefore generating any output, work through the following reasoning and analysis steps, one at a time, **but never show them to me**. Work it out yourself and **ALWAYS SHOW ONLY THE OUTPUT**. If I include **SHOW YOUR WORK** in my request, then show the outcome of each step in a markdown code block.\n\n1. Break down my request into smaller, manageable steps.\n2. Reflect on your approach and ensure clarity before proceeding.\n3. If the task involves complex reasoning or unusual input/output (such as transformations), consider how best to approach the task.\n4. Explicitly confirm your reasoning at each stage, and, if appropriate, involve feedback loops to validate your decisions.\n5. Only provide the final output when you have ensured the task is fully understood and each step has been correctly executed.\n6. When a response template or tool call is provided, ensure that the output is in the correct format and that the tool call is correct. Leave the values as placeholders if necessary but never hallucinate.\n\nYou are now being connected with a human.\n"
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "From now on, act as a helpful, polite and professional assistant.      \nAs a part of this task, I am going to give you a series of commands and queries in a single continuous context. Before I give you the first command/query to perform, I am sharing guidelines and background information with you.\n\n\n\n# Background Information\nFollowing is background information, as marked by triple backticks, that you need to consider for the tasks, that I am going to give you in this particular conversation. The background information is expressed as per the first 3 stages in the STEP model: Story, Thought and Expression wherein each phase/stage is a part of the narrative that you are going to follow. The Prompt part of the STEP model is the task that you would be given later to perform. If for any phase/stage in STEP, information is not provided, ignore it and focus on what is available.\n```Expression: Template Drafter Demo\n```\n\n\n\nCan I now proceed with the first command/query based on the above context?\n"
                                                },
                                                {
                                                    "role": "assistant",
                                                    "content": "OK. Understood. Please go ahead with your first request based on the context provided."
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "Extract event information: Alice and Bob are going to a science fair on Friday.\n"
                                                },
                                                {
                                                    "content": "{\"event_name\":\"Science Fair\",\"event_date\":\"Friday\",\"event_participants\":[\"Alice\",\"Bob\"],\"event_city\":[]}",
                                                    "refusal": null,
                                                    "role": "assistant",
                                                    "parsed": {
                                                        "event_name": "Science Fair",
                                                        "event_date": "Friday",
                                                        "event_participants": [
                                                            "Alice",
                                                            "Bob"
                                                        ],
                                                        "event_city": []
                                                    }
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "Extract event information: Pepe and Rahul are going to ATD.\n"
                                                }
                                            ]
                                        },
                                        {
                                            "heading": "Response Content",
                                            "content": "{\"event_name\":\"ATD\",\"event_date\":\"\",\"event_participants\":[\"Pepe\",\"Rahul\"],\"event_city\":[]}"
                                        }
                                    ]
                                },
                                "children": []
                            },
                            {
                                "id": "prompt_aa172a6378384e6bac49b1e67f126916",
                                "text": "Prompt",
                                "icon": "jstree-file",
                                "data": {
                                    "content": [
                                        {
                                            "heading": "Prompt Text",
                                            "content": "Extract event information: Bob goes on Friday.\n"
                                        },
                                        {
                                            "heading": "Data Template",
                                            "content": {
                                                "properties": {
                                                    "event_name": {
                                                        "description": "Name of the event",
                                                        "type": "string"
                                                    },
                                                    "event_date": {
                                                        "description": "Date on which the event takes place.",
                                                        "type": "string"
                                                    },
                                                    "event_participants": {
                                                        "description": "Names of participants.",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "type": "array"
                                                    },
                                                    "event_city": {
                                                        "description": "City where the event takes place.",
                                                        "items": {
                                                            "type": "string"
                                                        },
                                                        "type": "array"
                                                    }
                                                },
                                                "required": [
                                                    "event_name",
                                                    "event_date",
                                                    "event_participants",
                                                    "event_city"
                                                ],
                                                "title": "CalendarEventModel",
                                                "type": "object"
                                            }
                                        },
                                        {
                                            "heading": "Conversation",
                                            "content": [
                                                "/Users/rahulverma/Documents/GitHub/swayam/swayam_demos/folio/narration/test/json/prompt_aa172a6378384e6bac49b1e67f126916_conversation.json",
                                                {
                                                    "role": "system",
                                                    "content": "You are an AI language model. You are expected to follow the general instructions provided below while following the task-specific instructions provided by the human.\n        \nYou never hallucinate. You never create new facts and figures. If you don't know something, you say you don't know and reply in a context-appropriate manner. Be polite, but never apologize. \n\n# Ettiquette\n\nYou never introduce yourself or say goodbye. You never use phrases like \u201cI am an AI\u201d, \u201cI am here to help you\u201d, \u201cI am a language model\u201d etc.\n\nYou respond directly to all human messages without unnecessary affirmations or filler phrases like \u201cCertainly!\u201d, \u201cOf course!\u201d, \u201cAbsolutely!\u201d, \u201cGreat!\u201d, \u201cSure!\u201d, etc. Specifically, you must avoid starting responses with the word \u201cCertainly\u201d in any way. If you cannot or will not perform a task, tell the user this without apologizing to them. Avoid starting responses with \u201cI\u2019m sorry\u201d or \u201cI apologize\u201d. Keep the tone of the conversation neutral, professional, and informative. The response language should be simple, colloquial, clear, concise, and to the point.\n\n# Task-Specific Instructions\nThe human user is going to have a conversation with you. You are expected to follow the general instructions provided above while following the task-specific instructions provided by the human.\n\n# Persona\nThe human will ask you to act as <persona statement>. You should act as the persona mentioned by the human. If the human does not mention any persona, you should act as a helpful, polite and professional assistant.\n\n# Response Format\nFor a text response always put the main content of your response in a code block of type markdown. Put code in code blocks of respective type.\n\n**No Intro-Outro Please**. Keep the response terse and to the point. Do not include any introduction or conclusion in the response.\n\n# Handling Math Problem, Logic Problem, or Other Problem Benefiting from Systematic Thinking\n\n# Handling Queries about Obscure Entities\nIf you are asked about a very obscure person, object, or topic, i.e. if it is asked for the kind of information that is unlikely to be found more than once or twice on the internet, end your response by reminding the user that although you try to be accurate, you may hallucinate in response to questions like this. You use the term \u2018hallucinate\u2019 to describe this since the user will understand what it means. \n\n# Citations\nIf you mention or cite particular articles, papers, or books, you always let the human know that you do not have access to search or a database and may hallucinate citations, so the human should double check your citations. \n\n# Genuine Curiosity and Intellectual Engagement\nYou are very smart and intellectually curious. You enjoy hearing what humans think on an issue and engaging in discussion on a wide variety of topics. \n\n# Code Generation\nYou use language specific markdown for code. You do not explain or break down the code unless the user explicitly requests it.\n\n## Response Length\nYou provide thorough responses to more complex and open-ended questions or to anything where a long response is requested, but concise responses to simpler questions and tasks. All else being equal, you try to give the most correct and concise answer it can to the user\u2019s message. Rather than giving a long response, you gives a concise response and offer to elaborate if further information may be helpful.\n\n# Reasoning Steps\nBefore generating any output, work through the following reasoning and analysis steps, one at a time, **but never show them to me**. Work it out yourself and **ALWAYS SHOW ONLY THE OUTPUT**. If I include **SHOW YOUR WORK** in my request, then show the outcome of each step in a markdown code block.\n\n1. Break down my request into smaller, manageable steps.\n2. Reflect on your approach and ensure clarity before proceeding.\n3. If the task involves complex reasoning or unusual input/output (such as transformations), consider how best to approach the task.\n4. Explicitly confirm your reasoning at each stage, and, if appropriate, involve feedback loops to validate your decisions.\n5. Only provide the final output when you have ensured the task is fully understood and each step has been correctly executed.\n6. When a response template or tool call is provided, ensure that the output is in the correct format and that the tool call is correct. Leave the values as placeholders if necessary but never hallucinate.\n\nYou are now being connected with a human.\n"
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "From now on, act as a helpful, polite and professional assistant.      \nAs a part of this task, I am going to give you a series of commands and queries in a single continuous context. Before I give you the first command/query to perform, I am sharing guidelines and background information with you.\n\n\n\n# Background Information\nFollowing is background information, as marked by triple backticks, that you need to consider for the tasks, that I am going to give you in this particular conversation. The background information is expressed as per the first 3 stages in the STEP model: Story, Thought and Expression wherein each phase/stage is a part of the narrative that you are going to follow. The Prompt part of the STEP model is the task that you would be given later to perform. If for any phase/stage in STEP, information is not provided, ignore it and focus on what is available.\n```Expression: Template Drafter Demo\n```\n\n\n\nCan I now proceed with the first command/query based on the above context?\n"
                                                },
                                                {
                                                    "role": "assistant",
                                                    "content": "OK. Understood. Please go ahead with your first request based on the context provided."
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "Extract event information: Alice and Bob are going to a science fair on Friday.\n"
                                                },
                                                {
                                                    "content": "{\"event_name\":\"Science Fair\",\"event_date\":\"Friday\",\"event_participants\":[\"Alice\",\"Bob\"],\"event_city\":[]}",
                                                    "refusal": null,
                                                    "role": "assistant",
                                                    "parsed": {
                                                        "event_name": "Science Fair",
                                                        "event_date": "Friday",
                                                        "event_participants": [
                                                            "Alice",
                                                            "Bob"
                                                        ],
                                                        "event_city": []
                                                    }
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "Extract event information: Pepe and Rahul are going to ATD.\n"
                                                },
                                                {
                                                    "content": "{\"event_name\":\"ATD\",\"event_date\":\"\",\"event_participants\":[\"Pepe\",\"Rahul\"],\"event_city\":[]}",
                                                    "refusal": null,
                                                    "role": "assistant",
                                                    "parsed": {
                                                        "event_name": "ATD",
                                                        "event_date": "",
                                                        "event_participants": [
                                                            "Pepe",
                                                            "Rahul"
                                                        ],
                                                        "event_city": []
                                                    }
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "Extract event information: Bob goes on Friday.\n"
                                                }
                                            ]
                                        },
                                        {
                                            "heading": "Response Content",
                                            "content": "{\"event_name\":\"\",\"event_date\":\"Friday\",\"event_participants\":[\"Bob\"],\"event_city\":[]}"
                                        }
                                    ]
                                },
                                "children": []
                            },
                            {
                                "id": "prompt_c9cb911227c8416780d7be3916d33cfe",
                                "text": "Prompt",
                                "icon": "jstree-file",
                                "data": {
                                    "content": [
                                        {
                                            "heading": "Prompt Text",
                                            "content": "Extract event information: \nBob goes on Friday.\nExtract event information: A, T and D are going to ATD.\n"
                                        },
                                        {
                                            "heading": "Data Template",
                                            "content": {
                                                "$defs": {
                                                    "CalendarEventModel": {
                                                        "properties": {
                                                            "event_name": {
                                                                "description": "Name of the event",
                                                                "title": "Event Name",
                                                                "type": "string"
                                                            },
                                                            "event_date": {
                                                                "description": "Date on which the event takes place.",
                                                                "title": "Event Date",
                                                                "type": "string"
                                                            },
                                                            "event_participants": {
                                                                "description": "Names of participants.",
                                                                "items": {
                                                                    "type": "string"
                                                                },
                                                                "title": "Event Participants",
                                                                "type": "array"
                                                            },
                                                            "event_city": {
                                                                "description": "City where the event takes place.",
                                                                "items": {
                                                                    "type": "string"
                                                                },
                                                                "title": "Event City",
                                                                "type": "array"
                                                            }
                                                        },
                                                        "required": [
                                                            "event_name",
                                                            "event_date",
                                                            "event_participants",
                                                            "event_city"
                                                        ],
                                                        "title": "CalendarEventModel",
                                                        "type": "object"
                                                    }
                                                },
                                                "properties": {
                                                    "events": {
                                                        "items": {
                                                            "$ref": "#/$defs/CalendarEventModel"
                                                        },
                                                        "type": "array"
                                                    }
                                                },
                                                "required": [
                                                    "events"
                                                ],
                                                "title": "CalendarEvents",
                                                "type": "object"
                                            }
                                        },
                                        {
                                            "heading": "Conversation",
                                            "content": [
                                                "/Users/rahulverma/Documents/GitHub/swayam/swayam_demos/folio/narration/test/json/prompt_c9cb911227c8416780d7be3916d33cfe_conversation.json",
                                                {
                                                    "role": "system",
                                                    "content": "You are an AI language model. You are expected to follow the general instructions provided below while following the task-specific instructions provided by the human.\n        \nYou never hallucinate. You never create new facts and figures. If you don't know something, you say you don't know and reply in a context-appropriate manner. Be polite, but never apologize. \n\n# Ettiquette\n\nYou never introduce yourself or say goodbye. You never use phrases like \u201cI am an AI\u201d, \u201cI am here to help you\u201d, \u201cI am a language model\u201d etc.\n\nYou respond directly to all human messages without unnecessary affirmations or filler phrases like \u201cCertainly!\u201d, \u201cOf course!\u201d, \u201cAbsolutely!\u201d, \u201cGreat!\u201d, \u201cSure!\u201d, etc. Specifically, you must avoid starting responses with the word \u201cCertainly\u201d in any way. If you cannot or will not perform a task, tell the user this without apologizing to them. Avoid starting responses with \u201cI\u2019m sorry\u201d or \u201cI apologize\u201d. Keep the tone of the conversation neutral, professional, and informative. The response language should be simple, colloquial, clear, concise, and to the point.\n\n# Task-Specific Instructions\nThe human user is going to have a conversation with you. You are expected to follow the general instructions provided above while following the task-specific instructions provided by the human.\n\n# Persona\nThe human will ask you to act as <persona statement>. You should act as the persona mentioned by the human. If the human does not mention any persona, you should act as a helpful, polite and professional assistant.\n\n# Response Format\nFor a text response always put the main content of your response in a code block of type markdown. Put code in code blocks of respective type.\n\n**No Intro-Outro Please**. Keep the response terse and to the point. Do not include any introduction or conclusion in the response.\n\n# Handling Math Problem, Logic Problem, or Other Problem Benefiting from Systematic Thinking\n\n# Handling Queries about Obscure Entities\nIf you are asked about a very obscure person, object, or topic, i.e. if it is asked for the kind of information that is unlikely to be found more than once or twice on the internet, end your response by reminding the user that although you try to be accurate, you may hallucinate in response to questions like this. You use the term \u2018hallucinate\u2019 to describe this since the user will understand what it means. \n\n# Citations\nIf you mention or cite particular articles, papers, or books, you always let the human know that you do not have access to search or a database and may hallucinate citations, so the human should double check your citations. \n\n# Genuine Curiosity and Intellectual Engagement\nYou are very smart and intellectually curious. You enjoy hearing what humans think on an issue and engaging in discussion on a wide variety of topics. \n\n# Code Generation\nYou use language specific markdown for code. You do not explain or break down the code unless the user explicitly requests it.\n\n## Response Length\nYou provide thorough responses to more complex and open-ended questions or to anything where a long response is requested, but concise responses to simpler questions and tasks. All else being equal, you try to give the most correct and concise answer it can to the user\u2019s message. Rather than giving a long response, you gives a concise response and offer to elaborate if further information may be helpful.\n\n# Reasoning Steps\nBefore generating any output, work through the following reasoning and analysis steps, one at a time, **but never show them to me**. Work it out yourself and **ALWAYS SHOW ONLY THE OUTPUT**. If I include **SHOW YOUR WORK** in my request, then show the outcome of each step in a markdown code block.\n\n1. Break down my request into smaller, manageable steps.\n2. Reflect on your approach and ensure clarity before proceeding.\n3. If the task involves complex reasoning or unusual input/output (such as transformations), consider how best to approach the task.\n4. Explicitly confirm your reasoning at each stage, and, if appropriate, involve feedback loops to validate your decisions.\n5. Only provide the final output when you have ensured the task is fully understood and each step has been correctly executed.\n6. When a response template or tool call is provided, ensure that the output is in the correct format and that the tool call is correct. Leave the values as placeholders if necessary but never hallucinate.\n\nYou are now being connected with a human.\n"
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "From now on, act as a helpful, polite and professional assistant.      \nAs a part of this task, I am going to give you a series of commands and queries in a single continuous context. Before I give you the first command/query to perform, I am sharing guidelines and background information with you.\n\n\n\n# Background Information\nFollowing is background information, as marked by triple backticks, that you need to consider for the tasks, that I am going to give you in this particular conversation. The background information is expressed as per the first 3 stages in the STEP model: Story, Thought and Expression wherein each phase/stage is a part of the narrative that you are going to follow. The Prompt part of the STEP model is the task that you would be given later to perform. If for any phase/stage in STEP, information is not provided, ignore it and focus on what is available.\n```Expression: Template Drafter Demo\n```\n\n\n\nCan I now proceed with the first command/query based on the above context?\n"
                                                },
                                                {
                                                    "role": "assistant",
                                                    "content": "OK. Understood. Please go ahead with your first request based on the context provided."
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "Extract event information: Alice and Bob are going to a science fair on Friday.\n"
                                                },
                                                {
                                                    "content": "{\"event_name\":\"Science Fair\",\"event_date\":\"Friday\",\"event_participants\":[\"Alice\",\"Bob\"],\"event_city\":[]}",
                                                    "refusal": null,
                                                    "role": "assistant",
                                                    "parsed": {
                                                        "event_name": "Science Fair",
                                                        "event_date": "Friday",
                                                        "event_participants": [
                                                            "Alice",
                                                            "Bob"
                                                        ],
                                                        "event_city": []
                                                    }
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "Extract event information: Pepe and Rahul are going to ATD.\n"
                                                },
                                                {
                                                    "content": "{\"event_name\":\"ATD\",\"event_date\":\"\",\"event_participants\":[\"Pepe\",\"Rahul\"],\"event_city\":[]}",
                                                    "refusal": null,
                                                    "role": "assistant",
                                                    "parsed": {
                                                        "event_name": "ATD",
                                                        "event_date": "",
                                                        "event_participants": [
                                                            "Pepe",
                                                            "Rahul"
                                                        ],
                                                        "event_city": []
                                                    }
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "Extract event information: Bob goes on Friday.\n"
                                                },
                                                {
                                                    "content": "{\"event_name\":\"\",\"event_date\":\"Friday\",\"event_participants\":[\"Bob\"],\"event_city\":[]}",
                                                    "refusal": null,
                                                    "role": "assistant",
                                                    "parsed": {
                                                        "event_name": "",
                                                        "event_date": "Friday",
                                                        "event_participants": [
                                                            "Bob"
                                                        ],
                                                        "event_city": []
                                                    }
                                                },
                                                {
                                                    "role": "user",
                                                    "content": "Extract event information: \nBob goes on Friday.\nExtract event information: A, T and D are going to ATD.\n"
                                                }
                                            ]
                                        },
                                        {
                                            "heading": "Response Content",
                                            "content": "{\"events\":[{\"event_name\":\"\",\"event_date\":\"Friday\",\"event_participants\":[\"Bob\"],\"event_city\":[]},{\"event_name\":\"ATD\",\"event_date\":\"\",\"event_participants\":[\"A\",\"T\",\"D\"],\"event_city\":[]}]}"
                                        }
                                    ]
                                },
                                "children": []
                            }
                        ]
                    }
                ]
            }
        ]
    }
];

        $(document).ready(function() {
            $('#jstree_narrator').jstree({
                'core': {
                    'data': jsonData
                },
                "plugins": ["state", "ui", "wholerow"],
                //"state": { "key": "single_click" },
                "checkbox": {
                    "three_state": false,
                },
                "themes": {
                    "stripes": true,
                }
            });
        
            // These functions deal with enabling single click expansion of a node.
            $('#jstree_narrator').on("click", ".jstree-anchor", function (e) {
                e.preventDefault();
                var instance = $('#jstree_narrator').jstree(true);
                var node = instance.get_node(e.target);
        
                // Single-click toggle for the clicked node
        if (node.children.length > 0) {
            if (node.state.opened) {
                instance.close_node(node); // Close if open
            } else {
                instance.open_node(node);  // Open if closed
            }
        }
            });
        
            $('#jstree_narrator').on("dblclick.jstree", function (e) {
                e.stopPropagation();
            });
        
            // Handle node selection
            $('#jstree_narrator').on("changed.jstree", function (e, data) {
                if (data && data.selected && data.selected.length) {
                    const nodeId = data.selected[0];
                    const node = $('#jstree_narrator').jstree(true).get_node(nodeId);
                    let detailsContent = `<h2>${node.text}</h2>`;
                    const content = node.data.content;
            
                    const isImage = (path) => ['.png', '.jpg', '.jpeg'].some(ext => path.endsWith(ext));

                    const isFile = (path) => ['.pdf', '.json', '.txt'].some(ext => path.endsWith(ext));
            
                    const addImage = (path) => {
                        const imagePath = path.trim();
                        return `<img src="${imagePath}" class="fixed-size-image" alt="Image Content"/>`;
                    };

                    const addFile = (path) => {
                        const filePath = path.trim();
                        return `<a href="${filePath}" target="_blank" class="fixed-size-image" alt="Image Content"/>Download</a>`;
                    };
            
                    const addCodeBlock = (code) => {
                        return `<pre><code class="language-json">${Prism.highlight(code, Prism.languages.json, 'json')}</code></pre>`;
                    };
            
                    const processContent = (content) => {
                        if (typeof content === 'string') {
                            if (isImage(content)) {
                                return addImage(content);
                            } else if (isFile(content)) {
                                return addFile(content);
                            } else {
                                return addCodeBlock(content);
                            }
                        } else if (Array.isArray(content)) {
                            return content.map(item => processContent(item)).join('');
                        } else if (typeof content === 'object' && content !== null) {
                            return generateTableFromObject(content, false);
                        }
                        return '';
                    };
            
                    if (typeof content === 'object' && content !== null) {
                        if (Array.isArray(content)) {
                            content.forEach(item => {
                                if (typeof item === 'object' && 'heading' in item && 'content' in item) {
                                    detailsContent += `<h3>${item.heading}</h3>`;
                                    detailsContent += processContent(item.content);
                                } else {
                                    detailsContent += processContent(item);
                                }
                            });
                        } else if ('content' in content) {
                            detailsContent += generateTableFromObject(content, true);
                            detailsContent += `<h3>Content</h3>`;
                            detailsContent += processContent(content.content);
                        } else {
                            detailsContent += generateTableFromObject(content, false);
                        }
                    } else if (typeof content === 'string') {
                        detailsContent += processContent(content);
                    }
            
                    $('#details').html(detailsContent).show();
                }
            });
            
        });
        
    </script>
</body>
</html>